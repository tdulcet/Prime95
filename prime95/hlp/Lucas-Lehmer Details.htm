<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:x="urn:schemas-microsoft-com:office:excel"
xmlns="http://www.w3.org/TR/REC-html40">
	

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Lucas-Lehmer%20Details_files/filelist.xml">
<title>Lucas-Lehmer Details</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>88</w:Zoom>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:25.0pt;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:white;
	mso-font-kerning:0pt;
	font-weight:bold;
	font-style:italic;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Arial Unicode MS";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 29.25pt 1.0in 65.95pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027">
  <o:colormru v:ext="edit" colors="#fc9"/>
  <o:colormenu v:ext="edit" fillcolor="none"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

	

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoPlainText><b><u><span style='font-size:16.0pt;mso-bidi-font-size:
10.0pt;font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'>LUCAS-LEHMER DETAILS</span></u></b><span style='font-family:"Times New Roman";
mso-fareast-font-family:"MS Mincho";color:black'> <o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>This program uses the Lucas-Lehmer primality test to
see if 2<sup>P</sup>-1 is prime.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>The Lucas sequence is defined as:<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'><span style='mso-tab-count:1'>              </span>S
(1) = 4<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'><span style='mso-tab-count:1'>              </span>S
(n+1) = (S (n)<sup>2</sup> - 2) mod (2<sup>P</sup>-1)<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>2<sup>P</sup>-1 is prime if and only if S (p-1) = 0.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>This program uses a discrete weighted transform (see
Mathematics of Computation, January 1994) to square numbers in the Lucas-Lehmer
sequence.<o:p></o:p></span></p>

<p class=MsoPlainText><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:black'>The <a
href="http://www.utm.edu/research/primes/mersenne.shtml#test"><span
style='color:black;text-decoration:none;text-underline:none'>Lucas-Lehmer
primality test</span></a> is remarkably simple. For example, to prove 2<sup>7</sup>
- 1 is prime: <o:p></o:p></span></p>

<pre><span style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:2'>                                    </span>S (0) = 4<o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:2'>                                    </span>S (1) = 4 * 4 - 2 mod 127 = 14<o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:2'>                                    </span>S (2) = 14 * 14 - 2 mod 127 = 67<o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:2'>                                    </span>S (3) = 67 * 67 - 2 mod 127 = 42<o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:2'>                                    </span>S (4) = 42 * 42 - 2 mod 127 = 111<o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:2'>                                    </span>S (5) = 111 * 111 - 2 mod 127 = 0<o:p></o:p></span></pre>

<p style='margin:0in;margin-bottom:.0001pt;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p style='margin:0in;margin-bottom:.0001pt;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>To implement the Lucas-Lehmer test efficiently, one
must find the fastest way to square huge numbers modulo 2<sup>P</sup>-1. Since
the late 1960's the fastest algorithm for squaring large numbers is to split
the large number into pieces forming a large array, then perform a <a
href="http://aurora.phys.utk.edu/~forrest/papers/fourier/index.html"><span
style='color:black;text-decoration:none;text-underline:none'>Fast Fourier
Transform (FFT)</span></a>, a squaring, and an Inverse Fast Fourier Transform
(IFFT). See the &quot;How Fast Can We Multiply?&quot; section in Knuth's Art of
Computer Programming vol. 2. In a January 1994 Mathematics of Computation
article by <a href="http://www.perfsci.com/"><span style='color:black;
text-decoration:none;text-underline:none'>Richard Crandall</span></a> and <a
href="http://www.faginfamily.net/barry"><span style='color:black;text-decoration:
none;text-underline:none'>Barry Fagin</span></a> titled &quot;Discrete Weighted
Transforms and Large-Integer Arithmetic&quot;, the concept of using an
irrational base FFT was introduced. This improvement more than doubled the
speed of the squaring by allowing us to use a smaller FFT and it performs the
mod 2<sup>P</sup>-1 step for free. Although GIMPS uses a floating point FFT for
reasons specific to the Intel Pentium architecture, Peter Montgomery showed
that an <a href="http://www2.netdoor.com/~acurry/mersenne/archive1/0295.html"><span
style='color:black;text-decoration:none;text-underline:none'>all-integer
weighted transform</span></a> can also be used.<o:p></o:p></span></p>

<p style='margin:0in;margin-bottom:.0001pt;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p style='margin:0in;margin-bottom:.0001pt;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>As mentioned in the last paragraph, GIMPS uses
floating point FFTs written in highly pipelined, cache friendly assembly language.
Since floating-point computations are inexact, after every iteration the
floating point values are rounded back to integers. The discrepancy between the
proper integer result and the actual floating-point result is called the
convolution error. If the convolution error ever exceeds 0.5 then the rounding
step will produce incorrect results - meaning a larger FFT should have been
used. One of GIMPS' error checks is to make sure the maximum convolution error
does not exceed 0.4. Unfortunately, this error check is fairly expensive and is
not done on every squaring. There is another error check that is fairly cheap.
One property of FFT squaring is that: <o:p></o:p></span></p>

<pre><span style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:1'>                  </span>(Sum of the input FFT values)<sup> 2</sup> = (sum of the output IFFT values)<o:p></o:p></span></pre>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:black'>Since
we are using floating-point numbers we must change the &quot;equals sign&quot;
above to &quot;approximately equals&quot;. If the two values differ by a
substantial amount, then you get a SUMINP!&nbsp;=&nbsp;SUMOUT error as
described in the readme.txt file. If the sum of the input FFT values is an
illegal floating point value such as infinity, then you get an ILLEGAL SUMOUT
error. Unfortunately, these error checks cannot catch all errors, which brings
us to our next section. <o:p></o:p></span></p>

<p style='margin:0in;margin-bottom:.0001pt;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p style='margin:0in;margin-bottom:.0001pt;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";color:black'>What are the chances that the Lucas-Lehmer test will
find a new Mersenne prime number? A simple approach is to repeatedly apply the
observation that the chance of finding a factor between 2<sup>X</sup> and 2<sup>X+1
</sup>is about 1/x. For example, you are testing 2<sup> 10000139</sup>-1 which
trial factoring has proved there are no factors less than 2<sup>64</sup>. The
chance that it is prime is the chance of no 65-bit factor * chance of no 66-bit
factor * ... * chance of no 5000070-bit factor. That is: <o:p></o:p></span></p>

<pre><span style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:1'>                  </span>64<span style="mso-spacerun: yes">   </span>65<span style="mso-spacerun: yes">         </span>5000069<o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:1'>                  </span>-- * -- * ... * -------<o:p></o:p></span></pre><pre><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'><span style='mso-tab-count:1'>                  </span>65<span style="mso-spacerun: yes">   </span>66<span style="mso-spacerun: yes">         </span>5000070<o:p></o:p></span></pre>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;mso-fareast-font-family:"MS Mincho";color:black'>This
simplifies to 64 / 5000070 or 1 in 78126. The general formula is how far
factored divided by (exponent divided by 2). There are <a
href="http://www.utm.edu/research/primes/notes/faq/NextMersenne.html"><span
style='color:black;text-decoration:none;text-underline:none'>more rigorous and
accurate analyses</span></a>, but even these are unproven. <o:p></o:p></span></p>

<p class=MsoPlainText style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
color:black'>&nbsp;<o:p></o:p></span></p>

</div>

</body>

</html>
